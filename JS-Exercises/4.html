<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 4</title>
</head>

<body>
  <script>
    let students = [
      {
        name: 'Vaishnavi',
        batch: 9,
        marks: {
          science: 80,
          social: 70,
          hindi: 80,
          maths: 100,
          english: 90,
        }
      }, {
        name: 'Abhishek',
        batch: 10,
        marks: {
          science: 75,
          social: 75,
          hindi: 62,
          maths: 81,
          english: 52,
        }
      }, {
        name: 'Pappu',
        batch: 10,
        marks: {
          science: 70,
          social: 72,
          hindi: 75,
          maths: 95,
          english: 82,
        }
      }, {
        name: 'Ram',
        batch: 9,
        marks: {
          science: 35,
          social: 24,
          hindi: 22,
          maths: 95,
          english: 67,
        }
      }, {
        name: 'Shyam',
        batch: 8,
        marks: {
          science: 80,
          social: 70,
          hindi: 80,
          maths: 100,
          english: 90,
        }
      }, {
        name: 'Lakshman',
        batch: 8,
        marks: {
          science: 45,
          social: 87,
          hindi: 65,
          maths: 78,
          english: 99,
        }
      }
    ]

    let averageMarks = 0
    let studentDetails = students.map((student) => {
        let marksArray = Object.values(student.marks)
        let totalMarks = 0
        marksArray.forEach(mark => totalMarks = totalMarks + mark)

        averageMarks = totalMarks / marksArray.length

        return {
          name : student.name,
          batch: student.batch,
          averageMarks: averageMarks
        }
    })

    studentDetails.sort((element1, element2) => element2.averageMarks - element1.averageMarks)

		console.log(studentDetails)

    const finalStudentDetails = []

    for(let i = 0; i < studentDetails.length - 1; ++i) {
      if(studentDetails[i].averageMarks === studentDetails[i + 1].averageMarks) {
        if(studentDetails[i + 1].batch < studentDetails[i].batch) {
          finalStudentDetails.push(studentDetails[i + 1])
          finalStudentDetails.push(studentDetails[i])
        }
      }
    }

    console.log(finalStudentDetails)
    

    // let finalStudentDetails = studentDetails.filter((student) => {
    //     let avgMarks = student.averageMarks
    //     let sortedMarks = avgMarks.forEach
    // })



        /* Q - Return array of students with following details:
            - name
            - batch
            - average marks secured

            Sort the array based on average marks (Topper first)
            If equal, then on basis of batch number (Lowest first)
        */
</script>
</body>
</html>